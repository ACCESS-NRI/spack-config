packages:
  # Completely ignoring lower-precedence configuration options is supported with the :: notation for keys
  mpi::
    require: openmpi
  cmake:
    externals:
    - spec: cmake@3.24.2
      prefix: /apps/cmake/3.24.2
    - spec: cmake@3.31.6
      prefix: /apps/cmake/3.31.6
    buildable: false
  openmpi:
    # https://spack.readthedocs.io/en/latest/configuration.html#environment-modifications
    externals:
    # ACCESS-ESM1.5 & ACCESS-OM2
    - spec: openmpi@4.0.2 %gcc@13.2.0
      prefix: /apps/openmpi/4.0.2
      modules: [openmpi/4.0.2]
      extra_attributes:
        environment:
          prepend_path:
            CMAKE_PREFIX_PATH: /apps/openmpi/4.0.2/include/GNU
    - spec: openmpi@4.0.7 %gcc@13.2.0
      prefix: /apps/openmpi/4.0.7
      modules: [openmpi/4.0.7]
      extra_attributes:
        environment:
          prepend_path:
            CMAKE_PREFIX_PATH: /apps/openmpi/4.0.7/include/GNU
    - spec: openmpi@4.1.5 %gcc@13.2.0
      prefix: /apps/openmpi/4.1.5
      modules: [openmpi/4.1.5]
      extra_attributes:
        environment:
          prepend_path:
            CMAKE_PREFIX_PATH: /apps/openmpi/4.1.5/include/GNU
    - spec: openmpi@4.1.7 %gcc@13.2.0
      prefix: /apps/openmpi/4.1.7
      modules: [openmpi/4.1.7]
      extra_attributes:
        environment:
          prepend_path:
            CMAKE_PREFIX_PATH: /apps/openmpi/4.1.7/include/GNU
    - spec: openmpi@5.0.5 %gcc@13.2.0
      prefix: /apps/openmpi/5.0.5
      modules: [openmpi/5.0.5]
      extra_attributes:
        environment:
          prepend_path:
            CMAKE_PREFIX_PATH: /apps/openmpi/5.0.5/include/GNU
    - spec: openmpi@5.0.8 %gcc@13.2.0
      prefix: /apps/openmpi/5.0.8
      modules: [openmpi/5.0.8]
      extra_attributes:
        environment:
          prepend_path:
            CMAKE_PREFIX_PATH: /apps/openmpi/5.0.8/include/GNU
    # ACCESS-ESM1.5 & ACCESS-OM2
    - spec: openmpi@4.0.2
      prefix: /apps/openmpi/4.0.2
      modules: [openmpi/4.0.2]
      extra_attributes:
        environment:
          prepend_path:
            CMAKE_PREFIX_PATH: /apps/openmpi/4.0.2/include/Intel
    - spec: openmpi@4.0.7
      prefix: /apps/openmpi/4.0.7
      modules: [openmpi/4.0.7]
      extra_attributes:
        environment:
          prepend_path:
            CMAKE_PREFIX_PATH: /apps/openmpi/4.0.7/include/Intel
    - spec: openmpi@4.1.5
      prefix: /apps/openmpi/4.1.5
      modules: [openmpi/4.1.5]
      extra_attributes:
        environment:
          prepend_path:
            CMAKE_PREFIX_PATH: /apps/openmpi/4.1.5/include/Intel
    - spec: openmpi@4.1.7
      prefix: /apps/openmpi/4.1.7
      modules: [openmpi/4.1.7]
      extra_attributes:
        environment:
          prepend_path:
            CMAKE_PREFIX_PATH: /apps/openmpi/4.1.7/include/Intel
    - spec: openmpi@5.0.5
      prefix: /apps/openmpi/5.0.5
      modules: [openmpi/5.0.5]
      extra_attributes:
        environment:
          prepend_path:
            CMAKE_PREFIX_PATH: /apps/openmpi/5.0.5/include/Intel
    - spec: openmpi@5.0.8
      prefix: /apps/openmpi/5.0.8
      modules: [openmpi/5.0.8]
      extra_attributes:
        environment:
          prepend_path:
            CMAKE_PREFIX_PATH: /apps/openmpi/5.0.8/include/Intel
    buildable: false
  perl:
    externals:
    - spec: perl@5.26.3
      prefix: /usr
    buildable: false
  python:
    externals:
    - spec: python@3.11.7
      prefix: /apps/python3/3.11.7
      modules: [python3/3.11.7]
      # $ module show python3-as-python
      # -------------------------------------------------------------------
      # /apps/Modules/modulefiles/python3-as-python:
      #
      # conflict        python2-as-python
      # setenv          NCI_PYTHONX_AS_PYTHON python3
      # -------------------------------------------------------------------
      extra_attributes:
        environment:
          set:
            NCI_PYTHONX_AS_PYTHON: python3
    buildable: false
  gcc:
    externals:
    - spec: gcc@15.1.0 languages:='c,c++,fortran'
      prefix: /apps/gcc/15.1.0/wrappers
      modules: [gcc/15.1.0]
      extra_attributes:
        compilers:
          c: /apps/gcc/15.1.0/wrappers/gcc
          cxx: /apps/gcc/15.1.0/wrappers/g++
          fortran: /apps/gcc/15.1.0/wrappers/gfortran
    - spec: gcc@14.2.0 languages:='c,c++,fortran'
      prefix: /apps/gcc/14.2.0/wrappers
      modules: [gcc/14.2.0]
      extra_attributes:
        compilers:
          c: /apps/gcc/14.2.0/wrappers/gcc
          cxx: /apps/gcc/14.2.0/wrappers/g++
          fortran: /apps/gcc/14.2.0/wrappers/gfortran
    # https://github.com/ACCESS-NRI/system-tools
    - spec: gcc@14.1.0 languages:='c,c++,fortran'
      prefix: /apps/gcc/14.1.0/wrappers
      modules: [gcc/14.1.0]
      extra_attributes:
        compilers:
          c: /apps/gcc/14.1.0/wrappers/gcc
          cxx: /apps/gcc/14.1.0/wrappers/g++
          fortran: /apps/gcc/14.1.0/wrappers/gfortran
    - spec: gcc@13.2.0 languages:='c,c++,fortran'
      prefix: /apps/gcc/13.2.0/wrappers
      modules: [gcc/13.2.0]
      extra_attributes:
        compilers:
          c: /apps/gcc/13.2.0/wrappers/gcc
          cxx: /apps/gcc/13.2.0/wrappers/g++
          fortran: /apps/gcc/13.2.0/wrappers/gfortran
    - spec: gcc@8.5.0 languages:='c,c++,fortran'
      prefix: /usr
      extra_attributes:
        compilers:
          c: /usr/bin/gcc
          cxx: /usr/bin/g++
          fortran: /usr/bin/gfortran
  intel-oneapi-compilers:
    # 2024.0.2 -> /apps/intel-tools/.packages/2024.0.1/compiler/2024.0
    # 2024.2.0 -> /apps/intel-tools/.packages/2024.2.0/compiler/2024.2
    # 2024.2.1 -> /apps/intel-tools/.packages/2024.2.1/compiler/2024.2
    # 2025.0.4 -> /apps/intel-tools/.packages/2025.0.1/compiler/2025.0
    # 2025.1.1 -> /apps/intel-tools/.packages/2025.1.3/compiler/2025.1
    # 2025.2.0 -> /apps/intel-tools/.packages/2025.2.0.575/compiler/2025.2
    externals:
    - spec: intel-oneapi-compilers@2025.2.0
      prefix: /apps/intel-tools/.packages/2025.2.0.575
      modules: [intel-compiler-llvm/2025.2.0]
      extra_attributes:
        compilers:
          c: /apps/intel-tools/wrappers/icx
          cxx: /apps/intel-tools/wrappers/icpx
          fortran: /apps/intel-tools/wrappers/ifx
    - spec: intel-oneapi-compilers@2025.1.1
      prefix: /apps/intel-tools/.packages/2025.1.3
      modules: [intel-compiler-llvm/2025.1.1]
      extra_attributes:
        compilers:
          c: /apps/intel-tools/wrappers/icx
          cxx: /apps/intel-tools/wrappers/icpx
          fortran: /apps/intel-tools/wrappers/ifx
  intel-oneapi-compilers-classic:
    externals:
    - spec: intel-oneapi-compilers-classic@2021.13.1
      prefix: /apps/intel-tools/intel-compiler-llvm/2024.2.1
      extra_attributes:
        compilers:
          fortran: /apps/intel-tools/intel-compiler-llvm/2024.2.1/bin/ifort
    - spec: intel-oneapi-compilers-classic@2021.10.0
      prefix: /apps/intel-ct/wrapper
      modules: [intel-compiler/2021.10.0]
      extra_attributes:
        compilers:
          c: /apps/intel-ct/wrapper/icc
          cxx: /apps/intel-ct/wrapper/icpc
          fortran: /apps/intel-ct/wrapper/ifort
    # ACCESS-OM2
    - spec: intel-oneapi-compilers-classic@19.0.5.281
      prefix: /apps/intel-ct/wrapper
      modules: [intel-compiler/2019.5.281]
      extra_attributes:
        compilers:
          c: /apps/intel-ct/wrapper/icc
          cxx: /apps/intel-ct/wrapper/icpc
          fortran: /apps/intel-ct/wrapper/ifort
    # ACCESS-ESM1.5
    - spec: intel-oneapi-compilers-classic@19.0.3.199
      prefix: /apps/intel-ct/wrapper
      modules: [intel-compiler/2019.3.199]
      extra_attributes:
        compilers:
          c: /apps/intel-ct/wrapper/icc
          cxx: /apps/intel-ct/wrapper/icpc
          fortran: /apps/intel-ct/wrapper/ifort
  llvm:
    externals:
    - spec: llvm@19.1.7+clang~flang~lld~lldb
      prefix: /usr
      extra_attributes:
        compilers:
          c: /usr/bin/clang
          cxx: /usr/bin/clang++
  all:
    target: [x86_64]
